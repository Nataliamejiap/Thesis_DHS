---
title: "Models thesis"
author: "Natalia Mejia"
date: "15/4/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Required packages

library(dplyr)
library(haven)
library(xtable)
library(plm)
library(pglm)
library(broom)
library(knitr) 
library(tidyverse)
library(tidyr)
library(haven)
library(stargazer)
library(kableExtra)
library(knitr)
library(expss)
library(forcats)
library(devtools)
library(questionr)
library(crunch)
library(table1)

```

```{r}
setwd("C:/Users/natim/Desktop/Thesis/Thesis2/Data/DHS")

#Getting final data

load("final_data.RData")
```

```{r}
#Model 1 education head of household and covariates

model1 <- glm(dropouts ~ educ_head + gender + resi + region , data = final_data, family = "binomial")

summary(model1)

exp(coef(model1))
```
```{r}
#Model 2 socioeconomic status of the household and covariates

model2 <- glm(dropouts ~ wealth + gender + resi + region , data = final_data, family = "binomial")

summary(model2)

exp(coef(model2))


```
```{r}
model3 <- glm(dropouts ~ mom_marital + gender + resi + region , data = final_data, family = "binomial")

summary(model3)

exp(coef(model3))

```
```{r}
model4 <- glm(dropouts ~ dad_marital + gender + resi + region , data = final_data, family = "binomial")

summary(model4)

exp(coef(model4))
```
```{r}
#Getting odd ratios and confidence intervals of each model to plot them with stargazer

#Model 1
OR.vector1 <- exp(coef(model1))
CI.vector1 <- exp(confint(model1))

p.values1 <- list(summary(model1)$coefficients[,4])

#Model 2
OR.vector2 <- exp(coef(model2))
CI.vector2 <- exp(confint(model2))

p.values2 <- list(summary(model2)$coefficients[,4])

#Model 3
OR.vector3 <- exp(coef(model3))
CI.vector3 <- exp(confint(model3))

p.values3 <- list(summary(model3)$coefficients[,4])

#Model 4

OR.vector4 <- exp(coef(model4))
CI.vector4 <- exp(confint(model4))

p.values4 <- list(summary(model4)$coefficients[,4])

```
```{r}
#Plotting

stargazer(model1, model2,model3, model4, coef = list(OR.vector1, OR.vector2, OR.vector3, OR.vector4), 
          title = "Table 3. Logistic regression estimates school dropouts and independent variables, estimates in odd ratios",
          ci = T,
ci.custom = list(CI.vector1, CI.vector2, CI.vector3, CI.vector4), single.row = F, type = "text", out = "models.htm",
p=
c(p.values1, p.values2, p.values3, p.values4))
```

